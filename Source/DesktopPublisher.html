<html>
<body>

<div id="divMain">

<!-- ui begins -->

<div>

<label><b>Desktop Publisher</b></label><br />
<p>Enter a document as JSON and click the buttons to display or export it.</p>
<label>Document as JSON:</label><br />
<textarea id="textareaDocumentAsJSON" cols="80" rows="32" wrap="off" >
{
	"name":"Invictus",
	"pageSizeInPixels":{"x":255,"y":330},
	"fonts": [ { "name":"sans-serif", "heightInPixels":10 } ],
	"pageDefns":
	[
		{
			"name": "PageDefn0",
			"zoneDefns":
			[
				{
					"name":"0",
					"pos":{"x":10,"y":10},
					"size":{"x":150,"y":80},
					"margin":{"x":20,"y":20},
					"pageOffsetNext":0,
					"zoneNameNext":"1"
				},
				{
					"name":"1",
					"pos":{"x":50,"y":110},
					"size":{"x":150,"y":80},
					"margin":{"x":20,"y":20},
					"pageOffsetNext":0,
					"zoneNameNext":"2"
				},
				{
					"name":"2",
					"pos":{"x":90,"y":210},
					"size":{"x":150,"y":80},
					"margin":{"x":20,"y":20},
					"pageOffsetNext":1,
					"zoneNameNext":"0"
				}
			]
		}
	],
	"textFiles":
	[
		{
			"name": "Invictus",
			"sourcePath": "../Content/Invictus.txt"
		}
	],
	"contentBlocks": 
	[
		{ 
			"name": "Content0", 
			"typeName": "TextFile", 
			"data": "Invictus"
		} 
	],
	"pages": 
	[
		{ "defnName": "PageDefn0" },
		{ "defnName": "PageDefn0" },
		{ "defnName": "PageDefn0" }
	],
	"contentAssignments": 
	[
		{
			"contentBlockName":"Content0",
			"pageIndex":0,
			"zoneName":"0"
		}
	]
}
</textarea>
</div>

<div>
	<button onclick="buttonRender_Clicked();">Render as Images</button>
	<button onclick="buttonExport_Clicked();">Export as .PNG.TAR</button>
</div>

<div id="divOutput" />

<!-- ui ends -->

</div>


<script type="text/javascript">

function buttonRender_Clicked()
{
	var textareaDocumentAsJSON = document.getElementById
	(
		"textareaDocumentAsJSON"
	);
	var documentAsJson = textareaDocumentAsJSON.value;
	var documentToDisplay = Document.deserialize(documentAsJson);
	documentToDisplay.initialize(buttonRender_Clicked_DocumentInitialized);
}

function buttonRender_Clicked_DocumentInitialized(document)
{
	document.update();
	document.draw();
}

function buttonExport_Clicked()
{
	var documentToExport = documentParseAndLayOut();
	var documentAsTarFile = documentToExport.toTarFile();
	var documentAsBytes = documentAsTarFile.toBytes();
	FileHelper.saveBytesAsFile(documentAsBytes, documentToExport.name + ".tar");
}

</script>

<script type="text/javascript" src="Extensions/ArrayExtensions.js"></script>
<script type="text/javascript" src="Extensions/StringExtensions.js"></script>

<script type="text/javascript" src="ContentAssignment.js"></script>
<script type="text/javascript" src="ContentBlock.js"></script>
<script type="text/javascript" src="ContentType.js"></script>
<script type="text/javascript" src="Coords.js"></script>
<script type="text/javascript" src="Display.js"></script>
<script type="text/javascript" src="Document.js"></script>
<script type="text/javascript" src="Font.js"></script>
<script type="text/javascript" src="Page.js"></script>
<script type="text/javascript" src="PageDefn.js"></script>
<script type="text/javascript" src="Zone.js"></script>
<script type="text/javascript" src="ZoneDefn.js"></script>
<script type="text/javascript" src="ByteHelper.js"></script>
<script type="text/javascript" src="ByteStream.js"></script>
<script type="text/javascript" src="FileHelper.js"></script>
<script type="text/javascript" src="TextStringFromFile.js"></script>

<script type="text/javascript" src="Tar/TarFile.js"></script>
<script type="text/javascript" src="Tar/TarFileEntry.js"></script>
<script type="text/javascript" src="Tar/TarFileEntryHeade.js"></script>
<script type="text/javascript" src="Tar/TarFileTypeFlag.js"></script>

